{% extends 'landing/landing2.html' %}

{% load url from future %}
{% load static %}
{% block title %}Edit {% endblock %}

{% block postArea %}
<div>
<div class="panel panel-primary">
<div class="panel-heading largeFont">Update your profile</div>
<form action="" enctype="multipart/form-data" method="post" id="editProfileForm">
{%csrf_token%}
 <div class="panel-body">
            <div class="success-message"></div>
			<div class="row clearfix">
			<div class="input-group floatL" style="width:47%;">
				<span class="input-group-addon">First Name:</span>
				<input type="text" class="form-control" name="first_name" value="{% if user.first_name%}{{user.first_name}}{% endif %}" placeholder=""/>

				</div>
				<div class="input-group floatL marginL" style="width:47%;">
				<span class="input-group-addon">Last Name:</span>
				<input type="text" class="form-control" name="last_name" value="{% if user.last_name%}{{user.last_name}}{% endif %}" placeholder=""/>
				</div>
				
			</div>
			<div class="row marginT" style="padding-left:0;">
				<div class="col-xs-2 col-md-3" style="margin-left:0;padding-left:0;">
					<div class="thumbnail" style="background-color:#eee;margin-bottom:0;">
					
					<div class="" id="uploadButton">
					</div>
					<div class="caption">
					<div class ="uploadedFilePanel2"></div>
					</div>
					</div>
				</div>
				<div class="col-xs-2 col-md-3">
				 <a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Angel.png" alt="" >
				</a>
				</div>
				<div class="col-xs-2 col-md-3">
				 <a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Devil.png" alt="" >
				</a>
				</div>
				<div class="col-xs-2 col-md-3">
				 <a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Girl.png" alt="" >
				</a>
				</div>
				<div class="col-xs-2 col-md-3">
				 <a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Kid.png" alt="" >
				</a>
				</div>
				<div class="col-xs-2 col-md-3">
				 <a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/King.png" alt="" >
				</a>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-2 col-md-3">
				</div>
				<div class="col-xs-2 col-md-3">
				<a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Mermaid.png" alt="" >
				</a>
				</div>
				<div class="col-xs-2 col-md-3">
				<a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Knight.png" alt="" >
				</a>
				</div>
				<div class="col-xs-2 col-md-3">
				<a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Princess.png" alt="" >
				</a>
				</div>
				<div class="col-xs-2 col-md-3">
				<a href="#" class="thumbnail avatarSelect">
					<img class="" data-src="holder.js/100%x180" src="/media/mugshots/avatars/Robot.png" alt="" >
				</a>
				</div>
			</div>
			<div class="row clearfix">
			
				<label for="id_about_me">Write something about yourself:</label>
				<textarea type="text" class="form-control floatL" id="id_about_me" style="resize:none;" name="about_me" value="" >{% if user.my_profile.about_me %}{{user.my_profile.about_me}}{% endif %}</textarea>
				
			</div>
			<div class="row clearfix marginT">
			<div class="input-group floatL" style="width:50%;">
				<span class="input-group-addon">Location:</span>
				<input type="text" class="form-control" name="location" value="{% if user.my_profile.location %}{{user.my_profile.location}}{% endif %}" placeholder=""/>
				</div>
				<div class="input-group floatL marginL" style="width:20%;">
				<span class="input-group-addon">Age:</span>
				<input type="text" class="form-control" name="age" value="{% if user.my_profile.age %}{{user.my_profile.age}}{% endif %}" placeholder=""/>
				</div>
				
			</div>
			<div class="row clearfix marginT">
			<button type="submit" id="updateProfile" class="btn btn-primary">Update</button>
                <button id="" onclick="parent.location='/{{user.username}}/'" class="btn btn-default">Cancel</button>
			<button id="passwordBtn" onclick="{%if user.is_active%}changePass('{{user.username}}');{%else%}actch(event);{%endif%}" class="btn btn-default marginL">Change password</button>
			<button id="emailBtn" onclick = "{% if user.is_active %}changeMail('{{user.username}}');{% else %} actch(event);{% endif %}" class="btn btn-default marginL">Change email</button>
			</div>
</div>
</form>
 <div id="initial_values">
<input type="hidden" value="{% if user.first_name%}{{user.first_name}}{% endif %}">
<input type="hidden" value="{% if user.last_name%}{{user.last_name}}{% endif %}">
 <input type="hidden" value="{% if user.my_profile.location %}{{user.my_profile.location}}{% endif %}">
<input type="hidden" value="{% if user.my_profile.age %}{{user.my_profile.age}}{% endif %}">
     <input type="hidden" value="{% if user.my_profile.about_me %}{{user.my_profile.about_me}}{% endif %}">
 </div>
</div>
   <input type="hidden" value="" id="profileImg">
    <input type="hidden" value="{{user.username}}" id="identificationString">
</div>

{% endblock %}
{% block newsFeed %}
{% endblock %}
         {% block footer %}
        {% include 'base/footer.html' %}
        {% endblock %}
{% block js %}
<script type ="text/javascript" src="{% static 'js/fileuploader.js' %}"></script>
<script type="text/javascript">
window.onload = function(){highlightpanel(document.URL,'{{user.username}}')};
	var stickyTop = $('#sideMenu').offset().top; // returns number 
 
	$(window).scroll(function(){ // scroll event  
 
    var windowTop = $(window).scrollTop(); // returns number
 
    if (stickyTop < windowTop) {
      $('.affix-top').css('position','fixed');
	  $('.affix-top').css('top','0px');
    }
    else {
      $('.affix-top').css('position','static');
	  $('.affix-top').css('top','0');
    } 
  });
	var uploader = new qq.FileUploader({
            action: "/upload/profile/mugshot/",
			template:'<div class="qq-uploader clearfix">' +
					'<div class="btn btn-default qq-upload-button floatL marginAuto" title="Upload your pic or choose Avatar"><img style="width:80%;" id="mugshotImage" src="{{user.get_profile.mugshot}}"/></div>' +
					'</div>',
			fileTemplate: '<div class="progress progress-striped active"><div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100">' +
                '<span class="qq-upload-file"></span>' +
				'<span class="qq-upload-size" style="display:none !important;"></span>' +
                '<a class="qq-upload-cancel" href="#">Cancel</a>' +
                '<span class="qq-upload-failed-text">Failed</span>' +
            '</div></div>',
            element: $('#uploadButton')[0],
			listElement: $('.uploadedFilePanel2')[0],
            multiple: false,
			onSubmit: function(id, fileName){$('.uploadedFilePanel2').show(); $('.avatarSelect').each(function(){$(this).removeClass('selectedAvatar')});},
            onComplete: function( id, fileName, responseJSON ) {
              if( responseJSON.success )
              {
			  if($('.uploadedFileUrl').length==0){
			  $('.qq-upload-file').after('<input class="uploadedFileUrl" type="hidden" value="'+responseJSON.path+'"/>');}else{
			  $('.uploadedFileUrl').val(responseJSON.path);
			  }
			  $('.qq-upload-button img').attr('src',responseJSON.path);
			  if($('.qq-upload-file').text().length>4){var txt=$('.qq-upload-file').text().substring(0,2)+'..';
				$('.qq-upload-file').text(txt);
			  }
			  if ($('.uploadedFilePanel2').find('div.alert').length==2){
              $('.uploadedFilePanel2').find('div.alert').first().remove();}
			  }
			  else{}},
            onAllComplete: function( uploads ) {
			  for(i=0;i<uploads.length;i++){
			  $('#profileImg').val(uploads[i]['response']['path']);
			  }},
            params: {
              'csrf_token': '{{ csrf_token }}',
              'csrf_name': 'csrfmiddlewaretoken',
              'csrf_xname': 'X-CSRFToken',
            }
          }) ;
$('.qq-upload-button').tooltip();
</script>
{% endblock %}